
<!DOCTYPE html>

<html lang="it">
<head>
<!-- script pdf-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>ZARA FORMAGGI di Zara Maurizio</title>
<!-- Leaflet CSS -->
<link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet"/>
<style>
    :root {
      --verde-scuro: #2f4f2f;
      --verde-chiaro: #8fbc8f;
      --giallo-ocra: #c9a602;
      --caldo: #f4e2d8;
    }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: var(--caldo);
      color: #333;
    }

    header {
      background-color: var(--verde-scuro);
      color: white;
      padding: 1rem;
      text-align: center;
    }

    .header-logo img {
      width: 100px;
      height: auto;
      margin-bottom: 0.5rem;
    }

    .header-title h1 {
      margin: 0;
    }

    .header-subtitle {
      margin-top: 0.5rem;
      font-size: 1.1rem;
    }

    nav {
      background-color: var(--verde-chiaro);
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
    }

    nav a {
      color: white;
      padding: 1rem;
      text-decoration: none;
      font-weight: bold;
      cursor: pointer;
    }

    nav a:hover {
      background-color: var(--giallo-ocra);
    }

    .section {
      padding: 2rem;
      display: none;
    }

    .section.active {
      display: block;
    }

    .gallery-placeholder {
      border: 2px dashed var(--verde-scuro);
      padding: 2rem;
      text-align: center;
      background-color: #fff;
    }

    footer {
      background-color: var(--verde-scuro);
      color: white;
      text-align: center;
      padding: 1rem;
    }

    .search-bar {
      margin: 1rem auto;
      text-align: center;
    }

    .search-bar input {
      padding: 0.5rem;
      width: 80%;
      max-width: 400px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    #map {
      width: 100%;
      max-width: 800px;
      height: 50vh;
      min-height: 300px;
      margin: 1rem auto;
      border: 2px solid var(--verde-scuro);
      border-radius: 8px;
    }

    .card-container {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
    }

    .card {
      background-color: #fff8ed;
      border: 1px solid #ccc;
      border-radius: 12px;
      width: 300px;
      padding: 1rem;
      text-align: center;
    }

    .card img {
      width: 100%;
      border-radius: 8px;
      height: auto;
    }

    .card h3 {
      margin-top: 0.5rem;
      color: #5d4037;
    }

    .card p {
      font-size: 0.95em;
      color: #4e342e;
    }

    @media (max-width: 600px) {
      nav a { padding: 0.5rem; }
      .card { width: 100%; }
    }
  </style>
</head>
<body>
<!-- CARRELLO FISSO IN ALTO A DESTRA -->
<!-- Sidebar Carrello -->
<div id="cart-sidebar" style="position:fixed;top:0;right:-400px;width:350px;height:100%;background:#fff;border-left:2px solid #ccc;box-shadow:-2px 0 5px rgba(0,0,0,0.1);z-index:9999;padding:1rem;transition:right 0.3s;overflow-y:auto;">
<h3>üõí Il tuo carrello</h3>
<ul id="cart-items"></ul>
<p><strong>Totale: <span id="cart-sidebar-total">‚Ç¨0.00</span></strong></p>
<button onclick="svuotaCarrello()" style="background:#c00;color:white;padding:8px 12px;border:none;border-radius:5px;">üßπ Svuota</button>
<button onclick="toggleCartSidebar()" style="margin-top:10px;">Chiudi</button>
</div>
<div id="floating-cart" onclick="toggleCartSidebar()" style="position:fixed;top:20px;right:20px;background:#4CAF50;color:#fff;padding:15px 20px;border-radius:50px;font-size:16px;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.3);z-index:9999;cursor:pointer;" title="Clicca per vedere il carrello">üõí Carrello: ‚Ç¨0.00</div>
<header>
<div class="header-logo">
<img alt="Logo Zara Formaggi" src="logo.png"/>
</div>
<div class="header-title">
<h1>ZARA FORMAGGI</h1>
<div class="header-subtitle">di Zara Maurizio</div>
</div>
<p>Rivendita di Prodotti tipici Sardi e tanto altro</p>
</header>
<nav>
<a onclick="showSection('home')">Home</a>
<a onclick="showSection('prodotti')">Acquista i nostri prodotti</a>
<a onclick="showSection('galleria')">Galleria</a>
<a onclick="showSection('chi-siamo')">Chi siamo</a>
<a onclick="showSection('servizi')">Servizi</a>
<a onclick="showSection('dove')">Dove ci trovi</a>
<a onclick="showSection('contatti')">Contatti</a>
</nav>
<div class="search-bar">
<input placeholder="Cerca nel sito..." type="text"/>
</div>
<main>
<section class="section active" id="home">
<h2>Benvenuti!</h2>
<p>Visita il sito per scoprire i nostri prodotti. Offriamo una selezione di eccellenze enogastronomiche sarde, con attenzione alla qualit√†, alla tradizione e al gusto autentico.</p>
</section>
<section class="section" id="chi-siamo">
<h2>Chi siamo</h2>
<p>ZARA FORMAGGI nasce dalla passione per i sapori autentici della Sardegna. Fondata da Maurizio Zara, l‚Äôattivit√† si dedica alla selezione e vendita di prodotti tipici come formaggi, salumi, dolci e molto altro. Tradizione e qualit√† sono il nostro marchio.</p>
</section>
<section class="section" id="prodotti">
<h2 style="text-align:center;">üßÄ I nostri prodotti</h2>
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1rem;">
<div class="card" style="background:#fff8ed; border-radius:8px; padding:1rem; text-align:center;">
<img alt="Formaggio Cuore" src="https://via.placeholder.com/200" style="width:100%; border-radius:6px;"/>
<h3>Formaggio Cuore</h3>
<p>Formaggio a pasta compatta, gusto delicato.</p>
<button onclick="aggiungiAlCarrello('Formaggio Cuore', 8.50)">Aggiungi al carrello (‚Ç¨8.50)</button>
</div>
<div class="card" style="background:#fff8ed; border-radius:8px; padding:1rem; text-align:center;">
<img alt="Gran Sirai" src="https://via.placeholder.com/200" style="width:100%; border-radius:6px;"/>
<h3>Formaggio Gran Sirai</h3>
<p>Stagionato intenso, profumo deciso.</p>
<button onclick="aggiungiAlCarrello('Gran Sirai', 11.00)">Aggiungi al carrello (‚Ç¨11.00)</button>
</div>
<div class="card" style="background:#fff8ed; border-radius:8px; padding:1rem; text-align:center;">
<img alt="Sirai Maturo" src="https://via.placeholder.com/200" style="width:100%; border-radius:6px;"/>
<h3>Sirai Maturo</h3>
<p>Sapore forte e persistente.</p>
<button onclick="aggiungiAlCarrello('Sirai Maturo', 10.00)">Aggiungi al carrello (‚Ç¨10.00)</button>
</div>
</div>
</section>
<section class="section" id="dove">
<h2>Dove ci trovi</h2>
<p>Ci trovi in <strong>Via Gramsci, Iglesias (CI), Sardegna</strong>, presso il Mercato Civico.</p>
<div id="map"></div>
</section>
<section class="section" id="servizi">
<h2>I nostri servizi</h2>
<ul>
<li>Vendita al dettaglio di prodotti tipici sardi</li>
<li>Confezioni regalo personalizzate</li>
<li>Spedizioni in tutta Italia</li>
<li>Degustazioni su prenotazione</li>
</ul>
<button onclick="svuotaCarrello()" style="background: #c00; color: white; margin-top: 10px; padding: 8px 12px; border: none; border-radius: 5px;" type="button">üßπ Svuota Carrello</button>
</section>
<section class="section" id="galleria">
<h2>Galleria</h2>
<div class="gallery-placeholder">
<p>Qui sar√† inserita la galleria di foto e video dei nostri prodotti e del punto vendita.</p>
</div>
</section>
<section class="section" id="contatti">
<h2>Contatti</h2>
<p>Per informazioni, ordini o richieste particolari, contattaci via email o telefono. (Spazio per modulo contatti e informazioni)</p>
</section>

<section class="section" id="checkout" style="padding: 2rem;">
<h2>üõçÔ∏è Completa il tuo Ordine</h2>
<ul id="cart" style="list-style:none; padding-left:0;"></ul>
<p><strong>Subtotale: <span id="subtotal">‚Ç¨0.00</span></strong></p>
<p><strong>Spedizione: <span id="shipping">‚Ç¨0.00</span></strong></p>
<p><strong>Totale: <span id="total">‚Ç¨0.00</span></strong></p>
<form id="order-form" method="POST">
<input name="nome" placeholder="Nome completo" required="" type="text"/><br/><br/>
<input name="email" placeholder="Email" required="" type="email"/><br/><br/>
<textarea name="indirizzo" placeholder="Indirizzo per la spedizione" rows="3"></textarea><br/><br/>
<input id="ordineHidden" name="ordine" type="hidden"/>
<button onclick="generaPDF()" style="margin-bottom:10px;" type="button">üìÑ Scarica PDF</button><br/>
<div id="express-checkout-element"></div>
<div id="payment-message" style="color:red;"></div>
</form>
</section>
</main>
<footer>
<p>¬© 2025 ZARA FORMAGGI di Zara Maurizio - Tutti i diritti riservati</p>
</footer>
<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    let mapInitialized = false;
    let map;

    function showSection(id) {
      document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
      document.getElementById(id)?.classList.add('active');

      if (id === 'dove') {
        if (!mapInitialized) {
          const coords = [39.3117602, 8.5351056];
          map = L.map('map').setView(coords, 18);
          L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap contributors'
          }).addTo(map);
          L.marker(coords).addTo(map).bindPopup('Via Gramsci, Mercato Civico - Iglesias, Sardegna').openPopup();
          mapInitialized = true;
        } else {
          setTimeout(() => map.invalidateSize(), 200);
        }
      }
    }
  </script>
<script>
  const products = [
    { name: "Pecorino Sardo", price: 12.90 },
    { name: "Ricotta Mustia", price: 9.50 },
    { name: "Crema di formaggio", price: 7.00 }
  ];

  const cartItems = [];

  function updateCart() {
    const cartList = document.getElementById('cart');
    const subtotalEl = document.getElementById('subtotal');
    const totalEl = document.getElementById('total');
    const floatingTotalEl = document.getElementById('floating-total');
    const ordineHidden = document.getElementById('ordineHidden');
    const shippingRadio = document.querySelector('input[name="spedizione"]:checked');
    
    cartList.innerHTML = '';
    let subtotal = 0;

    cartItems.forEach(item => {
      const li = document.createElement('li');
      li.textContent = `${item.name} - ‚Ç¨${item.price.toFixed(2)}`;
      cartList.appendChild(li);
      subtotal += item.price;
    });

    const shippingCost = shippingRadio && shippingRadio.value === 'spedizione' && cartItems.length > 0 ? 7.00 : 0.00;
    
    subtotalEl.textContent = `‚Ç¨${subtotal.toFixed(2)}`;
    document.getElementById('shipping').textContent = `‚Ç¨${shippingCost.toFixed(2)}`;
    const total = subtotal + shippingCost;
    totalEl.textContent = `‚Ç¨${total.toFixed(2)}`;
    floatingTotalEl.textContent = `‚Ç¨${total.toFixed(2)}`;

    ordineHidden.value = cartItems.map(i => `${i.name} - ‚Ç¨${i.price.toFixed(2)}`).join('\n');
  }

  function addToCart(product) {
    cartItems.push(product);
    updateCart();
  }

  function renderProducts() {
    const productList = document.getElementById('product-list');
    productList.innerHTML = '';

    products.forEach(prod => {
      const div = document.createElement('div');
      div.className = 'card';
      div.innerHTML = `
        <h3>${prod.name}</h3>
        <p>Prezzo: ‚Ç¨${prod.price.toFixed(2)}</p>
        <button onclick='addToCart(${JSON.stringify(prod)})' style="padding:8px 12px;background:#8fbc8f;color:white;border:none;border-radius:5px;cursor:pointer;">Aggiungi al carrello</button>
      `;
      productList.appendChild(div);
    });
  }

  document.addEventListener('DOMContentLoaded', () => {
    renderProducts();

    document.querySelectorAll('input[name="spedizione"]').forEach(radio => {
      radio.addEventListener('change', updateCart);
    });
  });
</script>
<!-- AGGIUNGI QUESTO PRIMA DI 
<script>
let carrello = JSON.parse(// localStorage.getItem("carrello")) || [];

function salvaCarrello() {
  // localStorage.setItem("carrello", JSON.stringify(carrello));
}

function aggiornaCarrello() {
  const lista = document.getElementById("cart");
  const totaleSpan = document.getElementById("total");
  const flottante = document.getElementById("floating-total");
  const hidden = document.getElementById("ordineHidden");
  const spedizione = document.querySelector("input[name='consegna']:checked")?.value;

  lista.innerHTML = "";
  let totale = 0;
  let riepilogo = "";

  carrello.forEach(item => {
    const subtotale = item.prezzo * item.quantita;
    totale += subtotale;

    const li = document.createElement("li");
    li.innerHTML = `
      <strong>${item.nome}</strong> - ‚Ç¨${item.prezzo.toFixed(2)} x 
      <input type="number" min="1" value="${item.quantita}" onchange="cambiaQuantita('${item.nome}', this.value)">
      = ‚Ç¨${subtotale.toFixed(2)}
      <button onclick="rimuoviDalCarrello('${item.nome}')">üóë</button>
    `;
    lista.appendChild(li);
    riepilogo += `${item.nome} x${item.quantita} = ‚Ç¨${subtotale.toFixed(2)}\n`;
  });

  const costoSpedizione = spedizione === "spedizione" ? 7 : 0;
  const totaleFinale = totale + costoSpedizione;

  if (totaleSpan) totaleSpan.textContent = `‚Ç¨${totaleFinale.toFixed(2)}`;
  if (flottante) flottante.textContent = `‚Ç¨${totaleFinale.toFixed(2)}`;
  if (hidden) hidden.value = riepilogo + `Totale: ‚Ç¨${totaleFinale.toFixed(2)}`;
}

function aggiungiAlCarrello(id) {
  const prodotto = prodotti.find(p => p.id === id);
  if (!prodotto) return;

  const esistente = carrello.find(i => i.nome === prodotto.nome);
  if (esistente) {
    esistente.quantita++;
  } else {
    carrello.push({ nome: prodotto.nome, prezzo: prodotto.prezzo, quantita: 1 });
  }

  salvaCarrello();
  aggiornaCarrello();
}

function cambiaQuantita(nome, valore) {
  const item = carrello.find(i => i.nome === nome);
  if (item) {
    const nuovaQuantita = parseInt(valore);
    if (nuovaQuantita > 0) {
      item.quantita = nuovaQuantita;
    } else {
      carrello = carrello.filter(i => i.nome !== nome);
    }
    salvaCarrello();
    aggiornaCarrello();
  }
}

function rimuoviDalCarrello(nome) {
  carrello = carrello.filter(i => i.nome !== nome);
  salvaCarrello();
  aggiornaCarrello();
}

function svuotaCarrello() {
  if (confirm("Sei sicuro di voler svuotare il carrello?")) {
    carrello = [];
    // localStorage.removeItem("carrello");
    aggiornaCarrello();
  }
}

document.addEventListener("DOMContentLoaded", () => {
  aggiornaCarrello();
  document.querySelectorAll("input[name='consegna']").forEach(radio => {
    radio.addEventListener("change", aggiornaCarrello);
  });
});
</script>


  <script>
    function toggleCartSidebar() {
      const sidebar = document.getElementById("cart-sidebar");
      sidebar.style.right = sidebar.style.right === "0px" ? "-400px" : "0px";
    }
  </script>

<script>
function renderCartSidebar() {
  const ul = document.getElementById("cart-items");
  const totalEl = document.getElementById("cart-sidebar-total");
  if (!ul || !totalEl) return;

  ul.innerHTML = "";
  let total = 0;

  carrello.forEach(item => {
    const li = document.createElement("li");
    const itemTotal = item.prezzo * item.quantita;
    total += itemTotal;
    li.innerHTML = `
      <strong>${item.nome}</strong><br>
      <button onclick="decrementa('${item.nome}')">‚ûñ</button>
      <span>${item.quantita}</span>
      <button onclick="incrementa('${item.nome}')">‚ûï</button>
      <button onclick="rimuoviDalCarrello('${item.nome}')">üóë</button>
      = ‚Ç¨${itemTotal.toFixed(2)}
    `;
    ul.appendChild(li);
  });

  totalEl.textContent = `‚Ç¨${total.toFixed(2)}`;
}

function incrementa(nome) {
  const item = carrello.find(i => i.nome === nome);
  if (item) {
    item.quantita++;
    salvaCarrello();
    aggiornaCarrello();
    renderCartSidebar();
  }
}

function decrementa(nome) {
  const item = carrello.find(i => i.nome === nome);
  if (item && item.quantita > 1) {
    item.quantita--;
    salvaCarrello();
    aggiornaCarrello();
    renderCartSidebar();
  }
}

const originalAggiornaCarrello = aggiornaCarrello;
aggiornaCarrello = function() {
  originalAggiornaCarrello();
  renderCartSidebar();
};

document.addEventListener("DOMContentLoaded", () => {
  renderCartSidebar();
});
</script>


<!-- Stripe Checkout Integration -->
<script src="https://js.stripe.com/v3/"></script>


<script>
  const stripe = Stripe("pk_test_1234567890"); // replace with real key
  fetch("/create-payment-intent")  // endpoint to your backend
    .then(res => res.json())
    .then(({ clientSecret }) => {
      const elements = stripe.elements({ clientSecret });
      const express = elements.create("expressCheckout", {
        buttonType: { card: 'pay', applePay: 'buy', googlePay: 'buy', paypal: 'buynow' }
      });
      express.mount("#express-checkout-element");
      express.on("confirm", async (e) => {
        const { error } = await stripe.confirmPayment({ elements, confirmParams: { return_url: "https://zaraformaggi.com/thank-you" }});
        if (error) {
          document.getElementById("payment-message").textContent = error.message;
        }
      });
    });
</script>

<script src="https://js.stripe.com/v3/"></script>
<script>
  const stripe = Stripe("pk_test_TUACHIAVE");
  fetch("/create-payment-intent", { method: "POST", headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ amount: 1200 }) })
    .then(res => res.json())
    .then(({ clientSecret }) => {
      const elements = stripe.elements({ clientSecret });
      const express = elements.create("expressCheckout", {
        buttonType: { card: 'pay', applePay: 'buy', googlePay: 'buy', paypal: 'buynow' }
      });
      express.mount("#express-checkout-element");
      express.on("confirm", async (e) => {
        const { error } = await stripe.confirmPayment({ elements, confirmParams: { return_url: "https://zaraformaggi.com/thank-you" }});
        if (error) {
          document.getElementById("payment-message").textContent = error.message;
        }
      });
    });
</script>

</body> --&gt;
<script src="https://www.paypal.com/sdk/js?client-id=sb¬§cy=EUR"></script>
<script>
  const prodotti = [
    { id: 1, nome: "Pecorino Sardo", prezzo: 20, disponibile: 10 },
    { id: 2, nome: "Ricotta Fresca", prezzo: 9.0, disponibile: 20 },
    { id: 3, nome: "Fiore Sardo", prezzo: 28.0, disponibile: 5 }
  ];

  let carrello = [];

  function aggiornaUI() {
    const elenco = document.getElementById("product-list");
    elenco.innerHTML = prodotti.map(p => `
      <div class="card">
        <h3>${p.nome}</h3>
        <p>Prezzo: ‚Ç¨${p.prezzo.toFixed(2)}</p>
        <p>Disponibili: ${p.disponibile}</p>
        <button onclick="aggiungiAlCarrello(${p.id})">Aggiungi</button>
      </div>
    `).join("");
  }

  function aggiornaCarrello() {
    const ul = document.getElementById("cart");
    ul.innerHTML = carrello.map(item => `<li>${item.nome} x${item.quantita} = ‚Ç¨${(item.prezzo * item.quantita).toFixed(2)}</li>`).join("");

    const subtotal = carrello.reduce((sum, item) => sum + item.prezzo * item.quantita, 0);
    document.getElementById("subtotal").innerText = `‚Ç¨${subtotal.toFixed(2)}`;

    const spedizione = document.querySelector("input[name='spedizione']:checked").value === "spedizione" ? 7 : 0;
    document.getElementById("shipping").innerText = `‚Ç¨${spedizione.toFixed(2)}`;

    const totale = subtotal + spedizione;
    document.getElementById("total").innerText = `‚Ç¨${totale.toFixed(2)}`;
    document.getElementById("floating-total").innerText = `‚Ç¨${totale.toFixed(2)}`;

    document.getElementById("ordineHidden").value = carrello.map(c => `${c.nome} x${c.quantita}`).join(", ");
  }

  function aggiungiAlCarrello(id) {
    const prodotto = prodotti.find(p => p.id === id);
    if (!prodotto || prodotto.disponibile <= 0) return;
    const esiste = carrello.find(c => c.id === id);
    if (esiste) {
      if (esiste.quantita < prodotto.disponibile) {
        esiste.quantita++;
      }
    } else {
      carrello.push({ ...prodotto, quantita: 1 });
    }
    aggiornaCarrello();
  }

  document.querySelectorAll("input[name='spedizione']").forEach(r => {
    r.addEventListener("change", aggiornaCarrello);
  });

  aggiornaUI();

     
<button onclick="svuotaCarrello()" style="margin-top: 10px; background: #d9534f; color: white; padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer;">
  üßπ Svuota Carrello
</button>

     
  paypal.Buttons({
    createOrder: (data, actions) => {
      const totale = document.getElementById("total").innerText.replace("‚Ç¨", "");
      return actions.order.create({
        purchase_units: [{ amount: { value: totale } }]
      });
    },
    onApprove: (data, actions) => {
      return actions.order.capture().then(function(details) {
        alert("Pagamento completato da " + details.payer.name.given_name);
      });
    }
  }).render("#paypal-button-container");
</script>
<script>
  async function downloadPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    let ordine = document.getElementById('ordineHidden').value || 'Nessun prodotto nel carrello.';
    let nome = document.querySelector('input[name="nome"]').value;
    let email = document.querySelector('input[name="email"]').value;
    let indirizzo = document.querySelector('textarea[name="indirizzo"]').value;
    let spedizione = document.querySelector('input[name="spedizione"]:checked')?.value || '';
    let totale = document.getElementById('total').textContent;

    let text = `ZARA FORMAGGI - Riepilogo ordine\n\n`;
    text += `üë§ Nome: ${nome}\nüìß Email: ${email}\nüè† Indirizzo: ${indirizzo || '-'}\nüöö Tipo spedizione: ${spedizione}\n\n`;
    text += `üßÄ Prodotti:\n${ordine}\n\nüí∞ Totale: ${totale}`;

    doc.setFontSize(12);
    doc.text(text, 10, 20);
    doc.save('ordine_zaraformaggi.pdf');
  }
</script>
<script>
  const { jsPDF } = window.jspdf;

  function salvaOrdinePDF() {
    const doc = new jsPDF();

    // üî∂ LOGO: Base64 (accorciato qui, usa la versione completa che ti ho dato)
    const logoBase64 = "data:image/png;base64,..."; // Usa la tua stringa completa Base64 qui

    // Inserisci il logo
    doc.addImage(logoBase64, 'PNG', 15, 10, 40, 40);

    // üî∂ INTESTAZIONE
    doc.setFontSize(18);
    doc.text("ZARA FORMAGGI", 60, 20);
    doc.setFontSize(12);
    doc.text("di Zara Maurizio", 60, 28);
    doc.text("Riepilogo ordine", 15, 60);

    // üî∂ DATI CLIENTE (prendili dai campi del form)
    const nome = document.querySelector("#nome").value;
    const email = document.querySelector("#email").value;
    const indirizzo = document.querySelector("#indirizzo").value;

    doc.text(`Cliente: ${nome}`, 15, 70);
    doc.text(`Email: ${email}`, 15, 78);
    doc.text(`Indirizzo: ${indirizzo}`, 15, 86);

    // üî∂ PRODOTTI ORDINATI (esempio statico ‚Äî puoi modificarlo)
    const prodotti = [
      "Pecorino Sardo DOP - ‚Ç¨12.00",
      "Ricotta fresca - ‚Ç¨5.50"
    ];
    let y = 100;
    prodotti.forEach((prod, i) => {
      doc.text(`‚Ä¢ ${prod}`, 20, y + i * 10);
    });

    doc.text("Totale: ‚Ç¨17.50", 20, y + prodotti.length * 10 + 10);

    // üî∂ RINGRAZIAMENTO
    doc.setFontSize(14);
    doc.text("Grazie per il tuo acquisto!", 15, y + prodotti.length * 10 + 30);

    // üî∂ SALVA
    doc.save("ordine_zaraformaggi.pdf");
  }
</script>
<script>
  let carrello = JSON.parse(// localStorage.getItem("carrello")) || [];

  // Aggiungi prodotto
  function aggiungiAlCarrello(button) {
    const prodottoDiv = button.closest(".prodotto");
    const nome = prodottoDiv.dataset.nome;
    const prezzo = parseFloat(prodottoDiv.dataset.prezzo);

    const esistente = carrello.find(item => item.nome === nome);
    if (esistente) {
      esistente.quantita += 1;
    } else {
      carrello.push({ nome, prezzo, quantita: 1 });
    }

    salvaCarrello();
    aggiornaCarrello();
  }

  // Rimuovi prodotto
  function rimuoviDalCarrello(nome) {
    carrello = carrello.filter(item => item.nome !== nome);
    salvaCarrello();
    aggiornaCarrello();
  }

  // Cambia quantit√†
  function cambiaQuantita(nome, quantita) {
    const prodotto = carrello.find(item => item.nome === nome);
    if (prodotto) {
      prodotto.quantita = parseInt(quantita);
      if (prodotto.quantita <= 0) {
        rimuoviDalCarrello(nome);
      } else {
        salvaCarrello();
        aggiornaCarrello();
      }
    }
  }

  
  }

  // Aggiorna visualizzazione carrello
  function aggiornaCarrello() {
    const lista = document.getElementById("carrello");
    lista.innerHTML = "";
    let totale = 0;

    carrello.forEach(item => {
      const subtotale = item.prezzo * item.quantita;
      totale += subtotale;

      const li = document.createElement("li");
      li.innerHTML = `
        <strong>${item.nome}</strong> - ‚Ç¨${item.prezzo.toFixed(2)} x 
        <input type="number" value="${item.quantita}" min="1" style="width:40px" onchange="cambiaQuantita('${item.nome}', this.value)">
        = ‚Ç¨${subtotale.toFixed(2)}
        <button onclick="rimuoviDalCarrello('${item.nome}')">üóë</button>
      `;
      lista.appendChild(li);
    });

    document.getElementById("totale").textContent = `‚Ç¨${totale.toFixed(2)}`;
  }

  // Al caricamento della pagina
  document.addEventListener("DOMContentLoaded", () => {
    aggiornaCarrello();
  });
          
 
  aggiornaCarrello();
}   
          
</script>
<script>
let carrello = JSON.parse(// localStorage.getItem("carrello")) || [];

function salvaCarrello() {
  // localStorage.setItem("carrello", JSON.stringify(carrello));
}

function aggiornaCarrello() {
  const lista = document.getElementById("cart");
  const totaleSpan = document.getElementById("total");
  const flottante = document.getElementById("floating-total");
  const hidden = document.getElementById("ordineHidden");
  const spedizione = document.querySelector("input[name='consegna']:checked")?.value;

  lista.innerHTML = "";
  let totale = 0;
  let riepilogo = "";

  carrello.forEach(item => {
    const subtotale = item.prezzo * item.quantita;
    totale += subtotale;

    const li = document.createElement("li");
    li.innerHTML = `
      <strong>${item.nome}</strong> - ‚Ç¨${item.prezzo.toFixed(2)} x 
      <input type="number" min="1" value="${item.quantita}" onchange="cambiaQuantita('${item.nome}', this.value)">
      = ‚Ç¨${subtotale.toFixed(2)}
      <button onclick="rimuoviDalCarrello('${item.nome}')">üóë</button>
    `;
    lista.appendChild(li);
    riepilogo += `${item.nome} x${item.quantita} = ‚Ç¨${subtotale.toFixed(2)}\n`;
  });

  const costoSpedizione = spedizione === "spedizione" ? 7 : 0;
  const totaleFinale = totale + costoSpedizione;

  if (totaleSpan) totaleSpan.textContent = `‚Ç¨${totaleFinale.toFixed(2)}`;
  if (flottante) flottante.textContent = `‚Ç¨${totaleFinale.toFixed(2)}`;
  if (hidden) hidden.value = riepilogo + `Totale: ‚Ç¨${totaleFinale.toFixed(2)}`;
}

function aggiungiAlCarrello(id) {
  const prodotto = prodotti.find(p => p.id === id);
  if (!prodotto) return;

  const esistente = carrello.find(i => i.nome === prodotto.nome);
  if (esistente) {
    esistente.quantita++;
  } else {
    carrello.push({ nome: prodotto.nome, prezzo: prodotto.prezzo, quantita: 1 });
  }

  salvaCarrello();
  aggiornaCarrello();
}

function cambiaQuantita(nome, valore) {
  const item = carrello.find(i => i.nome === nome);
  if (item) {
    const nuovaQuantita = parseInt(valore);
    if (nuovaQuantita > 0) {
      item.quantita = nuovaQuantita;
    } else {
      carrello = carrello.filter(i => i.nome !== nome);
    }
    salvaCarrello();
    aggiornaCarrello();
  }
}

function rimuoviDalCarrello(nome) {
  carrello = carrello.filter(i => i.nome !== nome);
  salvaCarrello();
  aggiornaCarrello();
}

function svuotaCarrello() {
  if (confirm("Sei sicuro di voler svuotare il carrello?")) {
    carrello = [];
    // localStorage.removeItem("carrello");
    aggiornaCarrello();
  }
}

document.addEventListener("DOMContentLoaded", () => {
  aggiornaCarrello();
  document.querySelectorAll("input[name='consegna']").forEach(radio => {
    radio.addEventListener("change", aggiornaCarrello);
  });
});
</script>
<script>
    function toggleCartSidebar() {
      const sidebar = document.getElementById("cart-sidebar");
      sidebar.style.right = sidebar.style.right === "0px" ? "-400px" : "0px";
    }
  </script>
<script>
function renderCartSidebar() {
  const ul = document.getElementById("cart-items");
  const totalEl = document.getElementById("cart-sidebar-total");
  if (!ul || !totalEl) return;

  ul.innerHTML = "";
  let total = 0;

  carrello.forEach(item => {
    const li = document.createElement("li");
    const itemTotal = item.prezzo * item.quantita;
    total += itemTotal;
    li.innerHTML = `
      <strong>${item.nome}</strong><br>
      <button onclick="decrementa('${item.nome}')">‚ûñ</button>
      <span>${item.quantita}</span>
      <button onclick="incrementa('${item.nome}')">‚ûï</button>
      <button onclick="rimuoviDalCarrello('${item.nome}')">üóë</button>
      = ‚Ç¨${itemTotal.toFixed(2)}
    `;
    ul.appendChild(li);
  });

  totalEl.textContent = `‚Ç¨${total.toFixed(2)}`;
}

function incrementa(nome) {
  const item = carrello.find(i => i.nome === nome);
  if (item) {
    item.quantita++;
    salvaCarrello();
    aggiornaCarrello();
    renderCartSidebar();
  }
}

function decrementa(nome) {
  const item = carrello.find(i => i.nome === nome);
  if (item && item.quantita > 1) {
    item.quantita--;
    salvaCarrello();
    aggiornaCarrello();
    renderCartSidebar();
  }
}

const originalAggiornaCarrello = aggiornaCarrello;
aggiornaCarrello = function() {
  originalAggiornaCarrello();
  renderCartSidebar();
};

document.addEventListener("DOMContentLoaded", () => {
  renderCartSidebar();
});
</script>
<!-- Stripe Checkout Integration -->
<script src="https://js.stripe.com/v3/"></script>
<div id="express-checkout-element" style="margin: 2rem auto; max-width: 400px;"></div>
<div id="payment-message" style="text-align: center; color: red;"></div>
<script>
  const stripe = Stripe("pk_test_1234567890"); // replace with real key
  fetch("/create-payment-intent")  // endpoint to your backend
    .then(res => res.json())
    .then(({ clientSecret }) => {
      const elements = stripe.elements({ clientSecret });
      const express = elements.create("expressCheckout", {
        buttonType: { card: 'pay', applePay: 'buy', googlePay: 'buy', paypal: 'buynow' }
      });
      express.mount("#express-checkout-element");
      express.on("confirm", async (e) => {
        const { error } = await stripe.confirmPayment({ elements, confirmParams: { return_url: "https://zaraformaggi.com/thank-you" }});
        if (error) {
          document.getElementById("payment-message").textContent = error.message;
        }
      });
    });
</script>

</html>


  


  
